<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Automatic Backup of OpenERP Database &mdash; OpenERP Book 7.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.0.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="OpenERP Book 7.0 documentation" href="../../index.html" />
    <link rel="up" title="OpenERP Backup and Restore" href="../index.html" />
    <link rel="prev" title="Backup and Restore of OpenERP Database" href="../01/index.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-47926740-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          OpenERP Book</a>
        <span class="navbar-text navbar-version pull-left"><b>8.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="../../index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About OpenERP Online Book !</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../download/index.html">Looking for OpenERP Demo ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installation on Windows, Linux and MacOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../part01/index.html">Getting start with OpenERP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../part02/index.html">Leads to Cash Flow with OpenERP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../part03/index.html">Setup your First Company in OpenERP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../part04/index.html">Manage HR operations using OpenERP</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">OpenERP Backup and Restore</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Automatic Backup of OpenERP Database</a><ul>
<li><a class="reference internal" href="#create-a-script">Create a Script</a></li>
<li><a class="reference internal" href="#create-hourly-backup">Create Hourly Backup</a></li>
<li><a class="reference internal" href="#create-daily-backup">Create Daily Backup</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
  <li>
    <a href="../01/index.html" title="Previous Chapter: Backup and Restore of OpenERP Database"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Backup and Resto...</span>
    </a>
  </li>
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="automatic-backup-of-openerp-database">
<span id="backup-restore-auto"></span><h1>Automatic Backup of OpenERP Database<a class="headerlink" href="#automatic-backup-of-openerp-database" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some of the part of this page is contributed by <a class="reference external" href="http://opensourceenterprise.wordpress.com">http://opensourceenterprise.wordpress.com</a></p>
</div>
<p>OpenERP provides backup and restore functionality of its database on various platforms. You can take back and restore on locally installed server while you are allowed to take only backup from OpenERP online, If  you want to restore your database on OpenERP online you can contact to <a class="reference external" href="mailto:sales&#37;&#52;&#48;openerp&#46;com">sales<span>&#64;</span>openerp<span>&#46;</span>com</a>.</p>
<p>Here is a very simple steps for creating the OpenERP&#8217;s database backup automatically using the linux cron job when you have install OpenERP on your own server.</p>
<p>Create a folder under your home folder, here I have created backups.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> ~
<span class="nv">$ </span>mkdir backups
</pre></div>
</div>
<p>Create a new file under backups directory called pg_backup.sh</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>vim pg_backup.sh
</pre></div>
</div>
<div class="section" id="create-a-script">
<h2>Create a Script<a class="headerlink" href="#create-a-script" title="Permalink to this headline">¶</a></h2>
<p>Copy and paste the below content to your pg_backup.sh file.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#enable this option, if you are creating hourly backup</span>
<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;$2/`date +%F-%H`&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span>mkdir <span class="nv">$2</span>/<span class="sb">`</span>date +%F-%H<span class="sb">`</span>
    pg_dump <span class="nv">$1</span> &gt; <span class="nv">$2</span>/<span class="sb">`</span>date +%F-%H<span class="sb">`</span>/<span class="nv">$1</span>.sql
<span class="k">else</span>
<span class="k">    </span><span class="nb">echo</span> <span class="s2">&quot;Do not run this script manually !&quot;</span>
<span class="k">fi</span>

<span class="c">#enable this option, if you are creating daily backup</span>
<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;$2/`date +%F`&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span>mkdir <span class="nv">$2</span>/<span class="sb">`</span>date +%F<span class="sb">`</span>
    pg_dump <span class="nv">$1</span> &gt; <span class="nv">$2</span>/<span class="sb">`</span>date +%F<span class="sb">`</span>/<span class="nv">$1</span>.sql
<span class="k">else</span>
<span class="k">    </span><span class="nb">echo</span> <span class="s2">&quot;Do not run this script manually !&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>If you enable both part in pg_backup.sh, it will create a folders for hourly backup and daily backups too.</p>
<p>As this file should be an executable file and called by the root user of your linux system. So, you need to change the permission of file so that root can execute this file.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>chmod 755 pg_backup.sh
</pre></div>
</div>
<p>Now, we are going to execute this backup script through Linux Cronjob so we need to edit crontab list and add few lines to execute our backup script periodically. You can read full details what to write in crontab.</p>
</div>
<div class="section" id="create-hourly-backup">
<h2>Create Hourly Backup<a class="headerlink" href="#create-hourly-backup" title="Permalink to this headline">¶</a></h2>
<p>You can create a hourly backups using below commands</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo crontab -e
</pre></div>
</div>
<p>Add below lines to that edited file and save it.</p>
<div class="highlight-bash"><div class="highlight"><pre>@hourly /home/openerp/backups/pg_backup.sh database_name /home/openerp/backups/
</pre></div>
</div>
</div>
<div class="section" id="create-daily-backup">
<h2>Create Daily Backup<a class="headerlink" href="#create-daily-backup" title="Permalink to this headline">¶</a></h2>
<p>You can create a daily backups using below commands</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo crontab -e
</pre></div>
</div>
<p>Add below lines to that edited file and save it.</p>
<div class="highlight-bash"><div class="highlight"><pre>@daily /home/openerp/backups/pg_backup.sh database_name /home/openerp/backups/
</pre></div>
</div>
<p>You have setup Linux cronjob  successfully, the last setting you have to apply is to create a role in PostgreSQL database with the name root. Backup script is run by the crontab and it is executed by the root user so usually all execution is done by the root and if root user does not have access to PostgreSQL database our script will not be able to take the backup.</p>
<p>So, just execute the following commands on your linux shell, enter password when prompt and enter &#8220;y&#8221; when asked for Shall the new role be a superuser? (y/n)</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo su postgres
<span class="nv">$ </span>createuser root
</pre></div>
</div>
<p>Its Done !</p>
<p>However you can change the pg_backup.sh file to take the backup of large database, as text backup is not capable to handle large database where you have many blob objects in database. Read more about Backup and Restore of OpenERP Database to work with Large database.</p>
<p>Based on your configuration you will see the folders in your backups directory.</p>
<img alt="../../_images/backup_auto.png" src="../../_images/backup_auto.png" />
<p>Backup Directory</p>
</div>
</div>


		
		<div id="disqus_thread"></div>
	    <script type="text/javascript">
	        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	        var disqus_shortname = 'openerponlinebook'; // required: replace example with your forum shortname
	
	        /* * * DON'T EDIT BELOW THIS LINE * * */
	        (function() {
	            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	        })();
	    </script>
	    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	    
    </div>
    
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, OpenERP Book.<br/>
      Last updated on Feb 14, 2014.<br/>
    </p>
  </div>
</footer>
<div class="container">You can contribut to OpenERP Book on <a href="#">Launchpade.net</a>
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>